import{B as l}from"./story-helpers-DJRNUMPK.js";import{g as o}from"./gis-utils-Dz9V2CcG.js";class h extends l{constructor(r){if(super(`point-circle-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,r.attr||{},r.style||{}),this.data=Array.isArray(r.data)?{type:"FeatureCollection",features:r.data}:r.data,typeof r.r=="function")this.radiusFunction=r.r;else{const s=r.r||5;this.radiusFunction=()=>s}}render(r){this.layerGroup=this.createLayerGroup(r),this.renderCircles()}on(r,s){this.layerGroup&&this.layerGroup.selectAll("circle").on(r,function(t,e){s(t,e)})}setProjection(r){this.projection=r,this.layerGroup&&this.renderCircles()}renderCircles(){if(!this.layerGroup||!this.projection)return;this.layerGroup.selectAll("g.thematika-point-circle-layer").remove();const r=this.data.features.map((t,e)=>{let i;if(t.geometry.type==="Point")i=t.geometry.coordinates;else{const c=o(t);i=[c.x,c.y]}const a=this.projection(i);return{feature:t,index:e,x:a?a[0]:0,y:a?a[1]:0,r:this.radiusFunction(t,e)}}).filter(t=>t.x!==null&&t.y!==null),s=this.layerGroup.append("g").attr("class","thematika-point-circle-layer").selectAll("circle").data(r).enter().append("circle").attr("cx",t=>t.x).attr("cy",t=>t.y).attr("r",t=>t.r).attr("class",t=>{const e="thematika-point-circle",i=this.attr.className||"",a=t.feature.properties?.class||"";return[e,i,a].filter(Boolean).join(" ")});this.applyAllStylesToElements(s,this.layerGroup)}getData(){return this.data}}export{h as P};
